package com.bory.company.dao;

public class QueryFactory {
	
	public static String getQuery(String option) {

		String query = "";
		
		switch (option) {
		case "insert":
			query = "INSERT INTO EMP(EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)" 
					+ "VALUES(?,?,?,?,?,?,?,?)";
			break;
		case "update":
			query = "UPDATE EMP SET JOB = ?, MGR = ?, SAL = ?, COMM = ?, DEPTNO = ? WHERE EMPNO = ?";
			break;
		case "empno":
			query = "SELECT ENAME, JOB, EMPNO, MGR, SAL, COMM, DEPTNO, HIREDATE "
					+ " FROM EMP "
					+ " WHERE EMPNO = ?";
			break;
		case "all":
			query = " SELECT T.* " 
					+ " FROM(SELECT ROWNUM SEQ, E.*" 
					+ " FROM EMP E "
					+ " ORDER BY HIREDATE DESC) T" 
					+ " WHERE T.SEQ BETWEEN ? AND ?";
			break;
		case "ename":
			query = "SELECT * FROM EMP WHERE ENAME LIKE '%' || ? || '%'";
			break;
		case "dname":
			query = "SELECT E.* FROM EMP E WHERE E.DEPTNO = (SELECT D.DEPTNO FROM DEPT D WHERE DNAME = ?)";
			break;
		case "count":
			query = "SELECT COUNT(*)" + 
					"FROM EMP E, DEPT D" + 
					"WHERE E.DEPTNO = D.DEPTNO" + 
					"AND ? LIKE '%' || UPPER(?) || '%'";
			break;
		}
		return query;
	}
}
